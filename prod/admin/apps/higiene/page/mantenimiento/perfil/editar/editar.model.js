"use strict";import{environment}from"../../../../../../../environment.js";var KTPerfil=function(){var t,e,n,o,a,i,r,s,c,d,l,u,m,g=function(){a.classList.toggle("d-none"),c.classList.toggle("d-none"),i.classList.toggle("d-none")},p=function(){r.classList.toggle("d-none"),l.classList.toggle("d-none"),s.classList.toggle("d-none")},v=function(t){const e={id:document.querySelector("input[name='hd_id']").value,usuario:document.querySelector("#session_usuario_id").value,usuario_rol:document.querySelector("#session_rol_id").value},n=new URLSearchParams(e).toString();fetch(`${environment.apiSRD}/API/admin/obtener-por-id?${n}`,{method:"GET"}).then((t=>t.json())).then((t=>{1==t.estado?(t=t.data,document.querySelector("input[name='sh_cod']").value=t.codigo,document.querySelector("#lbl_usuario").textContent=t.usuario,document.querySelector("input[name='documento']").value=t.documento,document.querySelector("input[name='nombres']").value=t.nombres,document.querySelector("input[name='correo']").value=t.correo,0==t.estado?(document.getElementById("titulo").textContent="Activar cuenta",document.getElementById("kt_account_deactivate_account_submit").textContent="Activar cuenta",document.getElementById("titulo-aviso").textContent="Estas activando esta cuenta",document.getElementById("notice-div").classList.remove("bg-light-warning"),document.getElementById("notice-div").classList.remove("border-warning"),document.getElementById("notice-div").classList.add("bg-light-primary"),document.getElementById("notice-div").classList.add("border-primary"),document.getElementById("notice-icono").classList.remove("text-warning"),document.getElementById("notice-icono").classList.add("text-primary"),document.getElementById("kt_account_deactivate_account_submit").classList.remove("btn-danger"),document.getElementById("kt_account_deactivate_account_submit").classList.add("btn-primary")):(document.getElementById("titulo").textContent="Desactivar cuenta",document.getElementById("kt_account_deactivate_account_submit").textContent="Desactivar cuenta",document.getElementById("titulo-aviso").textContent="Estas desactivando esta cuenta",document.getElementById("notice-div").classList.remove("bg-light-primary"),document.getElementById("notice-div").classList.remove("border-primary"),document.getElementById("notice-div").classList.add("bg-light-warning"),document.getElementById("notice-div").classList.add("border-warning"),document.getElementById("notice-icono").classList.remove("text-primary"),document.getElementById("notice-icono").classList.add("text-warning"),document.getElementById("kt_account_deactivate_account_submit").classList.remove("btn-primary"),document.getElementById("kt_account_deactivate_account_submit").classList.add("btn-danger")),$("[name='desempenio']").val(t.desempenio).trigger("change"),$("[name='ocupacion']").val(t.ocupacion).trigger("change"),$("[name='nacionalidad']").val(t.nacionalidad).trigger("change"),document.querySelector("#sh_img").style.backgroundImage="url('assets/media/avatars/"+t.imagen+"')",$("[name='rol']").val(t.rol).trigger("change"),$("[name='estado']").val(t.estado).trigger("change")):(Swal.fire({text:"Lo siento,usuario o contraseña inválido",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, gracias",customClass:{confirmButton:"btn btn-primary"}}),validator.resetForm())}))};return{init:function(){var y;(t=document.getElementById("kt_usuario_cambio"),e=document.getElementById("kt_signin_change_password"),n=document.getElementById("kt_account_profile_details_form"),o=document.querySelector("#kt_account_deactivate_form"),a=document.getElementById("kt_usuario"),i=document.getElementById("kt_usuario_edit"),r=document.getElementById("kt_signin_password"),s=document.getElementById("kt_signin_password_edit"),c=document.getElementById("kt_usuario_button"),d=document.getElementById("kt_signin_cancel"),l=document.getElementById("kt_signin_password_button"),u=document.getElementById("kt_password_cancel"),m=document.querySelector("#kt_account_deactivate_account_submit"),o)&&($(".select-iconos").select2({templateSelection:optionFormat,templateResult:optionFormat}),v(),a&&(c.querySelector("button").addEventListener("click",(function(){g()})),d.addEventListener("click",(function(){g()})),l.querySelector("button").addEventListener("click",(function(){p()})),u.addEventListener("click",(function(){p()}))),n&&(y=FormValidation.formValidation(n,{fields:{sh_cod:{validators:{notEmpty:{message:"Código es obligatorio"}},stringLength:{min:8,max:8,message:"El código debe tener 8 caracteres"}},documento:{validators:{notEmpty:{message:"Contraseña es obligatoria"},stringLength:{min:8,max:20,message:"La contraseña debe tener entre 8 y 20 caracteres"}}},nombres:{validators:{notEmpty:{message:"El nombre es obligatorio"},stringLength:{max:50,message:"El nombre debe tener máximo 300 caracteres"}}},ocupacion:{validators:{notEmpty:{message:"La ocupación es obligatoria"}}},correo:{validators:{notEmpty:{message:"El correo es obligatorio"},emailAddress:{message:"El correo no es válido"}}},nacionalidad:{validators:{notEmpty:{message:"La nacionalidad es obligatoria"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row"})}}),n.querySelector("#kt_account_profile_details_submit").addEventListener("click",(function(t){t.preventDefault();let e=new FormData(n);e.append("usuario",document.querySelector("#session_usuario_id").value),e.append("usuario_rol",document.querySelector("#session_rol_id ").value),e.append("id",document.querySelector("input[name='hd_id']").value),y.validate().then((function(t){"Valid"==t?fetch(`${environment.apiSRD}/API/admin/actualizar-datos`,{method:"POST",body:e}).then((t=>t.json())).then((t=>{1==t.estado?swal.fire({text:"Se ha actualizado el usuario correctamente",icon:"success",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}}):Swal.fire({html:ErrorMensaje(t),icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn btn-primary"}})})):swal.fire({text:"Hay campos pendientes de validación, por favor revise el formulario.",icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}})}))}))),function(){var e;t&&(e=FormValidation.formValidation(t,{fields:{usuariocolab:{validators:{notEmpty:{message:"Usuario es obligatorio"},stringLength:{min:8,max:20,message:"El usuario debe tener entre 8 y 20 caracteres"}}},password1:{validators:{notEmpty:{message:"Contraseña es obligatoria"},stringLength:{min:8,max:20,message:"La contraseña debe tener entre 8 y 20 caracteres"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row"})}}),t.querySelector("#kt_signin_submit").addEventListener("click",(function(n){n.preventDefault();let o=new FormData(t);o.append("usuario",document.querySelector("#session_usuario_id").value),o.append("usuario_rol",document.querySelector("#session_rol_id ").value),o.append("id",document.querySelector("input[name='hd_id']").value),e.validate().then((function(n){"Valid"==n?fetch(`${environment.apiSRD}/API/admin/actualizar-datos`,{method:"POST",body:o}).then((t=>t.json())).then((n=>{1==n.estado?swal.fire({text:"Se ha actualizado el usuario correctamente",icon:"success",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}}).then((function(){t.reset(),e.resetForm(),g(),v()})):Swal.fire({html:ErrorMensaje(n),icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn btn-primary"}})})):swal.fire({text:"Hay campos pendientes de validación, por favor revise el formulario.",icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}})}))})))}(),function(){var t;e&&(t=FormValidation.formValidation(e,{fields:{password1:{validators:{notEmpty:{message:"La contraseña actual es obligatoria"}}},password2:{validators:{notEmpty:{message:"La nueva contraseña es obligatoria"}}},confirmpassword:{validators:{notEmpty:{message:"La confirmación de la contraseña es obligatoria"},identical:{compare:function(){return e.querySelector('[name="password2"]').value},message:"La contraseña y su confirmación no son iguales"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row"})}}),e.querySelector("#kt_password_submit").addEventListener("click",(function(n){n.preventDefault();let o=new FormData(e);o.append("usuario",document.querySelector("#session_usuario_id").value),o.append("usuario_rol",document.querySelector("#session_rol_id ").value),o.append("id",document.querySelector("input[name='hd_id']").value),t.validate().then((function(n){"Valid"==n?fetch(`${environment.apiSRD}/API/admin/actualizar-datos`,{method:"POST",body:o}).then((t=>t.json())).then((n=>{1==n.estado?swal.fire({text:"Se ha actualizado el usuario correctamente",icon:"success",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}}).then((function(){e.reset(),t.resetForm(),p(),v()})):Swal.fire({html:ErrorMensaje(n),icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn btn-primary"}})})):swal.fire({text:"Hay campos pendientes de validación, por favor revise el formulario.",icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}})}))})))}(),function(){var t;t=FormValidation.formValidation(o,{fields:{deactivate:{validators:{notEmpty:{message:"Tiene que aceptar para continuar"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,submitButton:new FormValidation.plugins.SubmitButton,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),m.addEventListener("click",(function(n){n.preventDefault();let o=new FormData;o.append("estado",1==document.querySelector("input[name='estado']").value?0:1),o.append("usuario",document.querySelector("#session_usuario_id").value),o.append("usuario_rol",document.querySelector("#session_rol_id ").value),o.append("id",document.querySelector("input[name='hd_id']").value),t.validate().then((function(n){"Valid"==n?fetch(`${environment.apiSRD}/API/admin/actualizar-datos`,{method:"POST",body:o}).then((t=>t.json())).then((n=>{1==n.estado?swal.fire({text:"Se ha actualizado el usuario correctamente",icon:"success",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}}).then((function(){e.reset(),t.resetForm(),v()})):Swal.fire({html:ErrorMensaje(n),icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn btn-primary"}})})):swal.fire({text:"Hay campos pendientes de validación, por favor revise el formulario.",icon:"error",buttonsStyling:!1,confirmButtonText:"Entendido",customClass:{confirmButton:"btn font-weight-bold btn-light-primary"}})}))}))}())}}}();KTUtil.onDOMContentLoaded((function(){KTPerfil.init()}));var optionFormat=function(t){if(!t.id)return t.text;var e=document.createElement("span"),n="";return n+='<img src="'+t.element.getAttribute("data-kt-select2-pais")+'" class="rounded-circle h-20px me-2" alt="image"/>',n+=t.text,e.innerHTML=n,$(e)};