"use strict";import{environment}from"../../../../../environment.js";var KTAMarcacion=function(){var e,a,o;return{init:function(){o=document.getElementById("form_marcacion"),a=document.getElementById("btn-buscar"),e=FormValidation.formValidation(o,{fields:{"codigo-colaborador":{validators:{notEmpty:{message:"El código del colaborador es requerido"},regexp:{regexp:/^[0-9]{7}$/,message:"El código debe ser de 7 dígitos"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),a.addEventListener("click",(t=>{t.preventDefault(),e&&e.validate().then((function(e){if("Valid"==e){msgLoad("Procesando..."),a.disabled=!0;var t=new FormData(o);t.append("usuario",$("#session_usuario_id").val()),t.append("usuario_rol",$("#session_rol_id").val()),t.append("fecha_hora","2024-05-01 19:31:00"),fetch(`${environment.apiSRD}/API/julia/asistencia/marcacion`,{method:"POST",body:t}).then((e=>e.json())).then((e=>{if(1==e.estado){document.getElementById("lbl-nombre").innerText=null==e.data.nombre?"---":e.data.nombre,document.getElementById("lbl-tipo").innerText=null==e.data.tipo?"---":e.data.tipo,null==e.data.hora||null==e.data.hora||""==e.data.hora?document.getElementById("lbl-hora").innerText="---":document.getElementById("lbl-hora").innerText=moment(e.data.hora).format("DD/MM/YYYY HH:mm:ss a"),document.getElementById("lbl-servicio").innerText=null==e.data.area?"---":e.data.area,document.getElementById("lbl-observaciones").innerText=null==e.data.obs?"---":e.data.obs,document.getElementById("imagen-colaborador").src=null==e.data.imagen?"assets/media/avatars/blank.png":`assets/media/avatars/${e.data.imagen}`,msgSuccessMixin("Los cambios han sido guardados exitosamente","");var a=document.querySelector('input[name="codigo-colaborador"]');a.focus(),a.select()}else msgError(ErrorMensaje(e),(()=>{2==e.estado&&location.reload()}),(()=>{2==e.estado&&location.reload()}))})).catch((e=>{msgError("Error al procesar los datos: "+e)})).finally((()=>{a.disabled=!1}))}}))}))}}}();KTUtil.onDOMContentLoaded((function(){KTAMarcacion.init()}));