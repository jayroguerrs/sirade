"use strict";import{environment}from"../../../../../../environment.js";var KTEvaluacion=function(){var e,a,t,n=function(){document.querySelector('[data-kt-servicio-table-filter="search"]').addEventListener("keyup",(function(e){a.search(e.target.value).draw()}))};return $("#custom-pdf").on("click",(function(e){e.preventDefault(),t.button(".buttons-pdf").trigger()})),$("#custom-excel").on("click",(function(e){e.preventDefault(),t.button(".buttons-excel").trigger()})),$("#custom-csv").on("click",(function(e){e.preventDefault(),t.button(".buttons-csv").trigger()})),$("#custom-copy").on("click",(function(e){e.preventDefault(),t.button(".buttons-copy").trigger()})),{init:function(){document.getElementById("form_modal_filtro_periodos"),e=$("#tb_periodos").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,select:{style:"single",toggleable:!1},order:[[1,"desc"]],stateSave:!1,ajax:{type:"POST",url:`${environment.apiSRD}/API/jci/encuestas/lista-periodo`,data:function(e){var a=ObtenerDatosPeriodo();e.periodo=a.periodo,e.fecha=a.fecha,e.estado=a.estado,e.usuario=$("#session_usuario_id").val(),e.usuario_rol=$("#session_rol_id").val()}},columns:[{data:0,name:"NPERI_ID"},{data:1,name:"CPERI_DESCRIPCION"},{data:2,name:"DPERI_INICIO"},{data:3,name:"DPERI_FIN"},{data:4,name:"ESTADO"},{data:5,name:"FEC_MODIFICACION"},{data:6,name:"USR_MODIFICACION"}],columnDefs:[{targets:0,visible:!1},{targets:4,visible:!0,render:function(e,a,t){return`\n                      <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${e}</div>\n                    `}}]}),e.$,e.on("draw.dt",(function(){e.row(":eq(0)").select()})),$("#tb_periodos").on("dblclick","tr",(function(e,t,o,r){$("#tb_periodos").DataTable().row(this).data();var s=document.getElementById("div-periodos"),i=document.getElementById("div-servicios");s.classList.contains("d-none")?(s.classList.remove("d-none"),i.classList.add("d-none")):(s.classList.add("d-none"),i.classList.remove("d-none")),(a=$("#tb_servicios").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,select:{style:"single",toggleable:!1},order:[[1,"asc"]],stateSave:!1,ajax:{type:"POST",url:`${environment.apiSRD}/API/jci/encuestas/lista-servicio`,data:function(e){var a=ObtenerDatosServicio();e.periodo=a.periodo,e.servicio=a.servicio,e.estado=a.estado,e.usuario=$("#session_usuario_id").val(),e.usuario_rol=$("#session_rol_id").val()}},columns:[{data:0,name:"CAREA_ID"},{data:1,name:"CAREA_DESCRIPCION"},{data:2,name:"ESTADO"},{data:3,name:"FEC_MODIFICACION"},{data:4,name:"USR_MODIFICACION"}],columnDefs:[{targets:0,visible:!1},{targets:2,visible:!0,render:function(e,a,t){return`\n                    <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${e}</div>\n                  `}}]})).on("draw",(function(){$('[data-bs-toggle="tooltip"]').tooltip(),KTMenu.createInstances(),n()})),a.on("draw.dt",(function(){a.row(":eq(0)").select()}))})),$("#tb_servicios").on("dblclick","tr",(function(e,a,o,r){$("#tb_servicios").DataTable().row(this).data();var s=document.getElementById("div-servicios"),i=document.getElementById("div-personal");s.classList.contains("d-none")?(s.classList.remove("d-none"),i.classList.add("d-none")):(s.classList.add("d-none"),i.classList.remove("d-none")),(t=$("#tb_personal").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,order:[[2,"asc"]],stateSave:!1,ajax:{type:"POST",url:`${environment.apiSRD}/API/jci/encuestas/lista`,data:function(e){var a=ObtenerDatosEncuesta();e.periodo=a.periodo,e.servicio=a.servicio,e.nacionalidad=a.nacionalidad,e.personal=a.personal,e.estado=a.estado,e.usuario=$("#session_usuario_id").val(),e.usuario_rol=$("#session_rol_id").val()}},columns:[{data:null,name:"acciones"},{data:0,name:"NJENC_ID"},{data:1,name:"NUSUA_ID"},{data:2,name:"CUSUA_IMG"},{data:3,name:"CUSUA_NOMBRES"},{data:4,name:"CUSUA_CORREO"},{data:5,name:"CAREA_ID"},{data:6,name:"CNACI_DESCRIPCION"},{data:7,name:"CNACI_IMAGEN"},{data:8,name:"NPERI_ID"},{data:9,name:"AVANCE"},{data:10,name:"PUNTAJE"},{data:11,name:"PUNTAJE_MAX"},{data:12,name:"NOTA_PORC"},{data:13,name:"PREG_CONTESTADAS"},{data:14,name:"TOTAL_PREGUNTAS"},{data:15,name:"ESTADO"},{data:16,name:"FEC_MODIFICACION"},{data:17,name:"USR_MODIFICACION"}],columnDefs:[{targets:0,visible:!0,orderable:!1,className:"text-start",render:function(e,a,t){return`\n                            <a href="?app=jci&page=evaluaciones/nuevo&periodo=${t[8]}&servicio=${t[5]}&colaborador=${t[1]}"" class="btn btn-sm btn-icon btn bg-light-info btn-active-color-primary w-30px h-30px">\n                                <i class="ki-duotone ki-notepad-edit text-info fs-2">\n                                    <span class="path1"></span>\n                                    <span class="path2"></span>\n                                    <span class="path3"></span>\n                                    <span class="path4"></span>\n                                    <span class="path5"></span>\n                                </i>\n                            </a>\n                            <a href="javascript:EliminarPeriodo('${t[0]}');" class="btn btn-sm btn-icon btn bg-light-warning btn-active-color-primary w-30px h-30px">\n                                <i class="ki-duotone ki-trash text-warning fs-2">\n                                    <span class="path1"></span>\n                                    <span class="path2"></span>\n                                    <span class="path3"></span>\n                                    <span class="path4"></span>\n                                    <span class="path5"></span>\n                                </i>\n                            </a>\n                        `}},{targets:1,visible:!1},{targets:2,visible:!1},{targets:3,visible:!1},{targets:4,visible:!0,className:"d-flex align-items-center",render:function(e,a,t){var n=t[2];if("blank.png"!=n)var o='<div class=symbol-label><img src="assets/media/avatars/'+n+'" alt="Avatar" class="w-100"></div>';else{var r=["success","danger","warning","info","dark","primary","secondary"][Math.floor(6*Math.random())],s=e.match(/\b\w/g)||[];o='<div class="symbol-label fs-3 bg-light-'+r+" text-"+r+'">'+(s=((s.shift()||"")+(s.pop()||"")).toUpperCase())+"</div>"}return`                        \n                      \x3c!--begin:: Avatar --\x3e\n                      <div class="symbol symbol-circle symbol-50px overflow-hidden me-3">\n                        <a href="/good/apps/user-management/users/view.html">\n                            ${o}\n                        </a>\n                      </div>\n                      \x3c!--end::Avatar--\x3e\n\n                      \x3c!--begin::User details--\x3e\n                      <div class="d-flex flex-column">\n                        <a href="#!" class="text-gray-800 text-hover-primary mb-1" data-bs-toggle="tooltip" title="Haga click aquí para cerrar su sesión">${e}</a>\n                        <span>${t[4]}</span>\n                      </div>\n                      \x3c!--end::User details--\x3e                        \n                    `}},{targets:5,visible:!1},{targets:6,visible:!1},{targets:7,visible:!0,render:function(e,a,t){return`                        \n                      \x3c!--begin::Flag--\x3e\n                      <img src="assets/media/flags/${t[7]}" class="w-25px me-3" style="width: 20px;border-radius: 4px" alt="" />\n                      \x3c!--end::Flag--\x3e\n                      <span class="text-dark fw-bold fs-7">${e}</span>                      \n                    `}},{targets:8,visible:!1},{targets:9,visible:!1},{targets:10,visible:!0,render:function(e,a,t){return`\n                      <div class="badge badge-light-${"100.0"==e?"success":"danger"} fw-bold">${e}%</div>\n                    `}},{targets:11,visible:!1},{targets:12,visible:!1},{targets:13,visible:!0,render:function(e,a,t){return`\n                      <div class="badge badge-light-primary fw-bold" ${"100.0"!=t[9]?'data-bs-toggle="tooltip" data-bs-placement="top" title="Debe terminar la evaluación para ver la nota"':""}>${"100.0"!=t[9]?"--":e} / 100</div>\n                    `}},{targets:14,visible:!1},{targets:15,visible:!1},{targets:16,visible:!1,render:function(e,a,t){return`\n                      <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${1==e?"ACTIVO":"INACTIVO"}</div>\n                    `}}]})).on("draw",(function(){$('[data-bs-toggle="tooltip"]').tooltip(),KTMenu.createInstances(),n()}))})),e.on("draw",(function(){KTMenu.createInstances()})),$("form#form_modal_filtro_periodos [name=filtro-fecha]").flatpickr({altInput:!0,altFormat:"d/m/Y",dateFormat:"Y-m-d",mode:"range",locale:"es"}),document.querySelector('[data-kt-periodo-table-filter="search"]').addEventListener("keyup",(function(a){e.search(a.target.value).draw()})),n(),document.querySelector('[data-kt-colaborador-table-filter="search"]').addEventListener("keyup",(function(e){t.search(e.target.value).draw()})),document.querySelector("#kt_modal_filtro_periodos_submit").addEventListener("click",(function(a){a.preventDefault(),Swal.fire({toast:!0,position:"top-end",icon:"success",title:"Los filtros se han aplicado exitosamente",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),$("#kt_modal_filtro_periodos").modal("hide"),e.ajax.reload()})),document.querySelector("#kt_modal_filtro_servicio_submit").addEventListener("click",(function(e){e.preventDefault(),Swal.fire({toast:!0,position:"top-end",icon:"success",title:"Los filtros se han aplicado exitosamente",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),$("#kt_servicio_filtro_modal").modal("hide"),a.ajax.reload()})),document.querySelector("#kt_modal_filtro_encuesta_submit").addEventListener("click",(function(e){e.preventDefault(),Swal.fire({toast:!0,position:"top-end",icon:"success",title:"Los filtros se han aplicado exitosamente",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),$("#kt_encuesta_filtro_modal").modal("hide"),t.ajax.reload()})),document.querySelector("#kt_modal_filtro_periodos_limpiar").addEventListener("click",(function(a){a.preventDefault(),document.getElementById("form_modal_filtro_periodos").reset(),$('[name="filtro-periodos"]').val(null).trigger("change"),$('[name="filtro-fecha"]').val(null).trigger("change"),$("form#form_modal_filtro_periodos [name=filtro-fecha]").flatpickr({altInput:!0,altFormat:"d/m/Y",dateFormat:"Y-m-d",mode:"range",locale:"es"}).setDate([null,null]),document.querySelector('input[name="filtro-estado"][value="1"]').checked=!1,document.querySelector('input[name="filtro-estado"][value="0"]').checked=!1,e.ajax.reload()})),document.querySelector("#kt_modal_filtro_servicio_limpiar").addEventListener("click",(function(e){e.preventDefault(),document.getElementById("form_modal_filtro_servicio").reset(),$('[name="filtro-servicio"]').val(null).trigger("change"),document.querySelector('input[name="filtro2-estado"][value="1"]').checked=!1,document.querySelector('input[name="filtro2-estado"][value="0"]').checked=!1,a.ajax.reload()})),document.querySelector("#kt_modal_filtro_encuesta_limpiar").addEventListener("click",(function(e){e.preventDefault(),document.getElementById("form_modal_filtro_encuesta").reset(),$('[name="filtro3-personal"]').val(null).trigger("change"),$('[name="filtro3-nacionalidad"]').val(null).trigger("change"),document.querySelector('input[name="filtro3-estado"][value="1"]').checked=!1,document.querySelector('input[name="filtro3-estado"][value="0"]').checked=!1,t.ajax.reload()}))}}}();function ObtenerDatosPeriodo(){var e,a=Boolean(document.querySelector('input[name="filtro-estado"][value="1"]').checked),t=Boolean(document.querySelector('input[name="filtro-estado"][value="0"]').checked);0==a&&0==t?e="":1==a&&0==t?e="1":0==a&&1==t&&(e="0");var n=new Array;return n.periodo=$("[name='filtro-periodo']").val(),n.fecha=$("[name='filtro-fecha']").val(),n.estado=e,n.usuario=$("#session_usuario_id").val(),n.usuario_rol=$("#session_rol_id").val(),n}function ObtenerDatosServicio(){var e,a=Boolean(document.querySelector('input[name="filtro2-estado"][value="1"]').checked),t=Boolean(document.querySelector('input[name="filtro2-estado"][value="0"]').checked);0==a&&0==t?e="":1==a&&0==t?e="1":0==a&&1==t&&(e="0");var n=new Array;return n.periodo=$("#tb_periodos").DataTable().row(".selected").data()[0],n.servicio=$("[name='filtro2-servicio']").val(),n.estado=e,n.usuario=$("#session_usuario_id").val(),n.usuario_rol=$("#session_rol_id").val(),n}function ObtenerDatosEncuesta(){var e,a=Boolean(document.querySelector('input[name="filtro3-estado"][value="1"]').checked),t=Boolean(document.querySelector('input[name="filtro3-estado"][value="0"]').checked);0==a&&0==t?e="":1==a&&0==t?e="1":0==a&&1==t&&(e="0");var n=new Array;return n.servicio=$("#tb_servicios").DataTable().row(".selected").data()[0],n.periodo=$("#tb_periodos").DataTable().row(".selected").data()[0],n.nacionalidad=$("[name='filtro3-nacionalidad']").val(),n.personal=$("[name='filtro3-personal']").val(),n.estado=e,n.usuario=$("#session_usuario_id").val(),n.usuario_rol=$("#session_rol_id").val(),n}KTUtil.onDOMContentLoaded((function(){KTEvaluacion.init()}));